# App Shell — Learnings

> **Change**: app-shell（Layout + Landing Page）
> **日期**: 2026-02-13 ~ 2026-02-18

---

## 色彩系統的演化：從「看起來不錯」到「有一致邏輯」

App Shell 的實作過程中，色彩系統經歷了幾次重要調整，最終收斂成一個有明確邏輯的三層結構。

### Footer 深色的問題

最初 Footer 用了深暖褐 `#2A2520`，想法是用跳色來區分頁尾。實作出來視覺上確實有對比，但實際看起來**像是不屬於網頁本身的區塊**——太突兀了，跟整體暖色調的頁面脫節。

討論了三個方向（淺色、暖深色、品牌色），最後選擇淺暖色 `#F5F0EB`，讓 Footer 融入整體但仍有層次感。

### Header 白色的問題

Footer 改成淺色後，回頭看 Header 的純白 `#FFFFFF` 也覺得不太協調——頁面中間是奶油白，上下卻是不同色系。

決定統一成暖色調，Header 用 `#FFFDF7`（最淺的暖白）。

### 最終的三層暖色漸層

```
Header:  #FFFDF7（暖白，最淺）  ← 2px 底部邊框
Page:    #F9F6F0（奶油白）
Footer:  #F5F0EB（暖灰米，最深）  ← 2px 頂部邊框
```

從上到下漸深，靠 **2px 粗邊框**做結構分隔而非靠色差。這符合 Neobrutalism 的核心精神：**邊框定義結構，而非顏色**。

### 學到的事

改一個顏色往往會連帶暴露其他不一致的地方。與其逐個修補，不如退一步思考整體的色彩邏輯，一次到位。

---

## CSS 變數的同步陷阱

### Tailwind v4 `@theme inline` 的行為

改 Header 背景色時踩了一個坑：在 `globals.css` 裡改了 `--color-surface-warm` 的值，但瀏覽器怎麼刷都是舊的。

原因是 Tailwind v4 的 `@theme inline` 會在**編譯時把值內聯到生成的 CSS 裡**，而不是發出 CSS custom property。所以改了源頭，編譯出來的 `.bg-surface-warm` class 還是寫死舊值。需要重啟 dev server 才會更新，有時甚至需要清快取。

### 專用變數 vs 共用變數

原本想直接改 `--color-surface-warm` 的值來讓 Header 變色，但這會連帶改掉所有用 `surface-warm` 的地方。最終的解法是**新增一個專用變數** `--color-surface-header: #FFFDF7`，讓 Header 有自己的背景色，不影響其他元素。

### 多處定義必須同步

色彩值散佈在三個地方：`STYLE_GUIDE.md`、`globals.css`、Pencil 設計稿變數。改了程式碼但忘了更新 STYLE_GUIDE 或 Pencil 變數，就會產生不一致。

**做法**：每次色彩調整後，主動盤點這三處是否同步。

---

## Pencil 設計稿的管理

### 設計稿組織

隨著元件越來越多，設計稿變得混亂——元件、頁面、參考用的色彩測試 frame 混在一起，找東西很費力。

討論了用 Frame 包區塊 vs 用標籤分區，最後選擇**扁平結構 + 文字標籤 + 分隔線**：
- 不增加巢狀層級（操作更簡單）
- 三個區域間距 ~1000px，視覺上明確分離
- 用灰色大寫文字 + 細線標示區塊邊界

### 動態行為的 Note 放置

一開始所有 note 都堆在同一個角落，跟它描述的元件距離很遠。改成**放在對應元素的左側** (x:-350)，這樣看到元件時馬上能看到它的動態行為說明。

### 新增元素時壓住既有內容

在設計稿裡新增元素或 note 時，多次發生不小心蓋住已有元素的情況。建立了 SOP：**新增前先 snapshot 確認位置，新增後檢查是否重疊**。

### Pencil 變數是 merge 模式

`set_variables` 預設是 merge，不會覆蓋舊值而是疊加。如果要修正一個變數的值，新值會被加在舊值後面形成陣列。要完全替換需要用 `replace: true`，但這會替換所有變數，風險較高。

---

## 流程上的收穫

### 設計稿與程式碼的同步時機

這次是先實作程式碼、再回頭更新設計稿。結果發現程式碼已經迭代了好幾版（sticky header、padding 調整、色彩變更），設計稿完全跟不上。

**建議**：程式碼有視覺相關的調整時，當下就同步更新設計稿，而不是累積到最後一次處理。差異越大，同步越痛苦。

### STYLE_GUIDE.md 是真正的 source of truth

三處色彩定義（STYLE_GUIDE、globals.css、Pencil 變數）中，`STYLE_GUIDE.md` 應該是**最權威的來源**。程式碼和設計稿都應該對齊它。每次色彩決策改變，第一個更新的應該是 STYLE_GUIDE。
